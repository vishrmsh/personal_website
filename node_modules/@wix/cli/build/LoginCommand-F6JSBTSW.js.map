{"version":3,"sources":["../src/components/LoginCommand/index.ts","../src/components/LoginCommand/LoginCommand.tsx","../src/components/LoginCommand/AlreadyLoggedIn.tsx"],"sourcesContent":["export { LoginCommand } from './LoginCommand.js';\n","import React, { useState, useCallback } from 'react';\nimport type { FC } from 'react';\nimport { Login, ApiKeyLogin } from '@wix/cli-auth';\nimport type { UserInfo } from '@wix/cli-auth';\nimport { Text, useExit } from '@wix/cli-ui-kit';\nimport { useErrorReporter } from '@wix/cli-error-reporting';\nimport { useBiLogger } from '@wix/cli-telemetry-react';\nimport type { VariantOf } from 'variant';\nimport { fields, match, variant } from 'variant';\nimport { addUserFields } from '../../bi.js';\nimport { AlreadyLoggedIn } from './AlreadyLoggedIn.js';\n\ninterface Props {\n  apiKeyToken?: string;\n  userInfo: UserInfo | null;\n}\n\nconst LoginState = variant({\n  PendingUserConfirmation: {},\n  InProgress: {},\n  Success: fields<{ userInfo: UserInfo }>(),\n});\ntype LoginState = VariantOf<typeof LoginState>;\n\nexport const LoginCommand: FC<Props> = ({\n  apiKeyToken,\n  userInfo: initialUserInfo,\n}) => {\n  const exit = useExit();\n  const errorReporter = useErrorReporter();\n  const biLogger = useBiLogger();\n  const [loginState, setLoginState] = useState<LoginState>(\n    initialUserInfo == null\n      ? LoginState.InProgress()\n      : LoginState.PendingUserConfirmation()\n  );\n\n  const handleLogin = useCallback(\n    ({ userInfo }: { userInfo: UserInfo }) => {\n      errorReporter.setUser({ id: userInfo.userId });\n      addUserFields(biLogger, userInfo.userId);\n      setLoginState(LoginState.Success({ userInfo }));\n    },\n    [setLoginState, errorReporter, biLogger]\n  );\n\n  return (\n    <>\n      {initialUserInfo && (\n        <AlreadyLoggedIn\n          userInfo={initialUserInfo}\n          onSubmit={(relogin) =>\n            relogin && setLoginState(LoginState.InProgress())\n          }\n        />\n      )}\n      {match(loginState, {\n        PendingUserConfirmation: () => null,\n        InProgress: () =>\n          apiKeyToken ? (\n            <ApiKeyLogin\n              token={apiKeyToken}\n              onLogin={handleLogin}\n              onError={exit}\n            />\n          ) : (\n            <Login onLogin={handleLogin} onError={exit} />\n          ),\n        Success: ({ userInfo }) => (\n          <Text>\n            Wix CLI is logged in to account{' '}\n            <Text skin=\"info\">{userInfo.email}</Text>\n          </Text>\n        ),\n      })}\n    </>\n  );\n};\n","import React from 'react';\nimport type { FC } from 'react';\nimport type { UserInfo } from '@wix/cli-auth';\nimport { Text, ConfirmInput } from '@wix/cli-ui-kit';\n\ninterface Props {\n  userInfo: UserInfo;\n  onSubmit: (relogin: boolean) => void;\n}\n\nexport const AlreadyLoggedIn: FC<Props> = ({ userInfo, onSubmit }) => {\n  return (\n    <>\n      <Text>\n        Wix CLI is currently logged in to account{' '}\n        <Text skin=\"info\">{userInfo.email}</Text>\n      </Text>\n      <ConfirmInput\n        label={'Do you want to log in to a different account?'}\n        initialValue={true}\n        onSubmit={onSubmit}\n      />\n    </>\n  );\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;ACAA;AAAA,IAAAA,gBAA6C;AAQ7C,qBAAuC;;;ACRvC;AAAA,mBAAkB;AAUX,IAAM,kBAA6B,CAAC,EAAE,UAAU,SAAS,MAAM;AACpE,SACE,6BAAAC,QAAA,2BAAAA,QAAA,gBACE,6BAAAA,QAAA,cAAC,YAAK,6CACsC,KAC1C,6BAAAA,QAAA,cAAC,QAAK,MAAK,UAAQ,SAAS,KAAM,CACpC,GACA,6BAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP,cAAc;AAAA,MACd;AAAA;AAAA,EACF,CACF;AAEJ;;;ADPA,IAAM,iBAAa,wBAAQ;AAAA,EACzB,yBAAyB,CAAC;AAAA,EAC1B,YAAY,CAAC;AAAA,EACb,aAAS,uBAA+B;AAC1C,CAAC;AAGM,IAAM,eAA0B,CAAC;AAAA,EACtC;AAAA,EACA,UAAU;AACZ,MAAM;AACJ,QAAM,OAAO,QAAQ;AACrB,QAAM,gBAAgB,iBAAiB;AACvC,QAAM,WAAW,YAAY;AAC7B,QAAM,CAAC,YAAY,aAAa,QAAI;AAAA,IAClC,mBAAmB,OACf,WAAW,WAAW,IACtB,WAAW,wBAAwB;AAAA,EACzC;AAEA,QAAM,kBAAc;AAAA,IAClB,CAAC,EAAE,SAAS,MAA8B;AACxC,oBAAc,QAAQ,EAAE,IAAI,SAAS,OAAO,CAAC;AAC7C,oBAAc,UAAU,SAAS,MAAM;AACvC,oBAAc,WAAW,QAAQ,EAAE,SAAS,CAAC,CAAC;AAAA,IAChD;AAAA,IACA,CAAC,eAAe,eAAe,QAAQ;AAAA,EACzC;AAEA,SACE,8BAAAC,QAAA,4BAAAA,QAAA,gBACG,mBACC,8BAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAU;AAAA,MACV,UAAU,CAAC,YACT,WAAW,cAAc,WAAW,WAAW,CAAC;AAAA;AAAA,EAEpD,OAED,sBAAM,YAAY;AAAA,IACjB,yBAAyB,MAAM;AAAA,IAC/B,YAAY,MACV,cACE,8BAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS;AAAA;AAAA,IACX,IAEA,8BAAAA,QAAA,cAAC,iBAAM,SAAS,aAAa,SAAS,MAAM;AAAA,IAEhD,SAAS,CAAC,EAAE,SAAS,MACnB,8BAAAA,QAAA,cAAC,YAAK,mCAC4B,KAChC,8BAAAA,QAAA,cAAC,QAAK,MAAK,UAAQ,SAAS,KAAM,CACpC;AAAA,EAEJ,CAAC,CACH;AAEJ;","names":["import_react","React","React"]}