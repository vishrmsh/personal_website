import { createRequire as _createRequire } from 'node:module';
const require = _createRequire(import.meta.url);
import {
  getProjectDependencies,
  saveWixLock
} from "./chunk-RUPEFN2Q.js";
import {
  createPackageManager,
  getRepoType
} from "./chunk-O3SZ563W.js";
import {
  init_esm_shims
} from "./chunk-4EFJZ3GQ.js";

// ../cli-site/src/services/dependencies.ts
init_esm_shims();
async function createDependenciesService(projectFolder, veloClient) {
  const repoType = await getRepoType(projectFolder);
  const packageManager = await createPackageManager(repoType);
  const updateWixLock = async () => {
    const dependencies = await getProjectDependencies(projectFolder);
    const wixLockContent = await veloClient.generateWixLockFile(dependencies);
    await saveWixLock(projectFolder, wixLockContent);
  };
  return {
    install: async (packageName) => {
      if (packageName) {
        await packageManager.runInstallPackage(projectFolder, packageName);
      } else {
        await packageManager.runInstall(projectFolder);
      }
      await updateWixLock();
    },
    uninstall: async (packageName) => {
      await packageManager.runUninstallPackage(projectFolder, packageName);
      await updateWixLock();
    }
  };
}

export {
  createDependenciesService
};
//# sourceMappingURL=chunk-D2J3WUXG.js.map