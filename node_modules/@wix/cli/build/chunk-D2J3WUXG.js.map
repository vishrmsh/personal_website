{"version":3,"sources":["../../cli-site/src/services/dependencies.ts"],"sourcesContent":["import type { VeloClient } from '@wix/velo-client';\nimport { getRepoType, createPackageManager } from '@wix/package-manager';\nimport { getProjectDependencies } from '../velo.js';\nimport { saveWixLock } from '../files/wix.lock.js';\n\nexport async function createDependenciesService(\n  projectFolder: string,\n  veloClient: VeloClient\n) {\n  const repoType = await getRepoType(projectFolder);\n  const packageManager = await createPackageManager(repoType);\n\n  const updateWixLock = async () => {\n    const dependencies = await getProjectDependencies(projectFolder);\n    const wixLockContent = await veloClient.generateWixLockFile(dependencies);\n\n    await saveWixLock(projectFolder, wixLockContent);\n  };\n\n  return {\n    install: async (packageName?: string) => {\n      if (packageName) {\n        await packageManager.runInstallPackage(projectFolder, packageName);\n      } else {\n        await packageManager.runInstall(projectFolder);\n      }\n\n      await updateWixLock();\n    },\n    uninstall: async (packageName: string) => {\n      await packageManager.runUninstallPackage(projectFolder, packageName);\n      await updateWixLock();\n    },\n  };\n}\n"],"mappings":";;;;;;;;;;;;;;;AAAA;AAKA,eAAsB,0BACpB,eACA,YACA;AACA,QAAM,WAAW,MAAM,YAAY,aAAa;AAChD,QAAM,iBAAiB,MAAM,qBAAqB,QAAQ;AAE1D,QAAM,gBAAgB,YAAY;AAChC,UAAM,eAAe,MAAM,uBAAuB,aAAa;AAC/D,UAAM,iBAAiB,MAAM,WAAW,oBAAoB,YAAY;AAExE,UAAM,YAAY,eAAe,cAAc;AAAA,EACjD;AAEA,SAAO;AAAA,IACL,SAAS,OAAO,gBAAyB;AACvC,UAAI,aAAa;AACf,cAAM,eAAe,kBAAkB,eAAe,WAAW;AAAA,MACnE,OAAO;AACL,cAAM,eAAe,WAAW,aAAa;AAAA,MAC/C;AAEA,YAAM,cAAc;AAAA,IACtB;AAAA,IACA,WAAW,OAAO,gBAAwB;AACxC,YAAM,eAAe,oBAAoB,eAAe,WAAW;AACnE,YAAM,cAAc;AAAA,IACtB;AAAA,EACF;AACF;","names":[]}