{"version":3,"sources":["../../cli-site-old/src/sync-types/index.ts","../../cli-site-old/src/sync-types/sync-types-with-auth.ts","../../cli-site-old/src/sync-types/sync-types.ts"],"sourcesContent":["export { syncTypesWithAuth } from './sync-types-with-auth.js';\nexport { syncTypes } from './sync-types.js';\n","import { mkdir } from 'node:fs/promises';\nimport { join } from 'node:path';\nimport type { AuthState } from '@wix/cli-auth';\nimport { syncRevisionTypes } from '@wix/velo-site-types-syncer';\nimport { writeJson } from '@wix/cli-fs';\nimport { CliError, CliErrorCode } from '@wix/cli-error';\nimport type { ProjectModel } from '../model.js';\n\nexport async function syncTypesWithAuth(\n  model: ProjectModel,\n  opts: {\n    authState: AuthState;\n  }\n) {\n  try {\n    const accessToken = await opts.authState.getAccessToken();\n    await syncRevisionTypes(model, { getAppToken: () => accessToken });\n\n    // TODO: this is temporarily here, will remove (netanelg@wix.com)\n    await mkdir(join(model.projectFolder, '.vscode/'), { recursive: true });\n    await writeJson(join(model.projectFolder, '.vscode/settings.json'), {\n      'files.associations': {\n        '*.jsw': 'javascript',\n      },\n    });\n  } catch (e) {\n    throw new CliError({\n      code: CliErrorCode.FailedToSyncToRevision({ revision: model.revision }),\n      cause: e,\n      info: { model },\n    });\n  }\n}\n","import type { CommandServices } from '@wix/cli-command-contract';\nimport type { ProjectModel } from '../model.js';\nimport { authenticate } from '../authentication.js';\nimport { syncTypesWithAuth } from './sync-types-with-auth.js';\n\nexport async function syncTypes(\n  model: ProjectModel,\n  { biLogger, errorReporter }: CommandServices\n) {\n  const authState = await authenticate({\n    metaSiteId: model.metaSiteId,\n    biLogger,\n    errorReporter,\n  });\n\n  return syncTypesWithAuth(model, { authState });\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;;ACAA;AAAA,SAAS,aAAa;AACtB,SAAS,YAAY;AAOrB,eAAsB,kBACpB,OACA,MAGA;AACA,MAAI;AACF,UAAM,cAAc,MAAM,KAAK,UAAU,eAAe;AACxD,UAAM,kBAAkB,OAAO,EAAE,aAAa,MAAM,YAAY,CAAC;AAGjE,UAAM,MAAM,KAAK,MAAM,eAAe,UAAU,GAAG,EAAE,WAAW,KAAK,CAAC;AACtE,UAAM,UAAU,KAAK,MAAM,eAAe,uBAAuB,GAAG;AAAA,MAClE,sBAAsB;AAAA,QACpB,SAAS;AAAA,MACX;AAAA,IACF,CAAC;AAAA,EACH,SAAS,GAAG;AACV,UAAM,IAAI,SAAS;AAAA,MACjB,MAAM,aAAa,uBAAuB,EAAE,UAAU,MAAM,SAAS,CAAC;AAAA,MACtE,OAAO;AAAA,MACP,MAAM,EAAE,MAAM;AAAA,IAChB,CAAC;AAAA,EACH;AACF;;;AChCA;AAKA,eAAsB,UACpB,OACA,EAAE,UAAU,cAAc,GAC1B;AACA,QAAM,YAAY,MAAM,aAAa;AAAA,IACnC,YAAY,MAAM;AAAA,IAClB;AAAA,IACA;AAAA,EACF,CAAC;AAED,SAAO,kBAAkB,OAAO,EAAE,UAAU,CAAC;AAC/C;","names":[]}