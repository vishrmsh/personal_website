{"version":3,"sources":["../../cli-astro-commands/src/non-interactive/logger.ts","../../cli-astro-commands/src/non-interactive/execute-command.tsx"],"sourcesContent":["export function log(message: string) {\n  // eslint-disable-next-line no-console\n  console.log(message);\n}\n","import React from 'react';\nimport type { ReactNode } from 'react';\nimport type { CommandServices } from '@wix/cli-command-contract';\nimport { addUserFields } from '@wix/cli-telemetry';\nimport { BiProvider } from '@wix/cli-telemetry-react';\nimport { DebugLogProvider } from '@wix/cli-debug-log';\nimport { getDebugLogFilePath } from '@wix/cli-core-definitions';\nimport { createRendererToString } from '@wix/cli-ui-kit';\nimport { ErrorReporterProvider } from '@wix/cli-error-reporting';\nimport { AccountAuthProvider, isLoggedInToAccount } from '@wix/cli-auth';\nimport { CliError, CliErrorCode } from '@wix/cli-error';\nimport { ProjectModelProvider } from '../model.js';\nimport type { ProjectModel } from '../model.js';\n\nexport async function executeCommand<T>(\n  services: CommandServices,\n  model: ProjectModel,\n  renderFn: (resolve: (data: T) => void) => ReactNode\n): Promise<T> {\n  const authData = await isLoggedInToAccount();\n\n  if (!authData) {\n    throw new CliError({\n      code: CliErrorCode.AuthenticationRequired(),\n      cause: null,\n    });\n  }\n\n  services.errorReporter.setUser({ id: authData.userInfo.userId });\n  addUserFields(services.biLogger, authData.userInfo.userId);\n\n  const renderer = createRendererToString({ stripAnsi: false });\n  const debugLogFilePath = getDebugLogFilePath(model.projectFolder);\n\n  return new Promise((resolve, reject) => {\n    renderer.render(\n      <BiProvider value={services.biLogger}>\n        <ErrorReporterProvider value={services.errorReporter}>\n          <AccountAuthProvider>\n            <DebugLogProvider filePath={debugLogFilePath}>\n              <ProjectModelProvider value={model}>\n                {renderFn((...args) => {\n                  renderer.unmount();\n                  resolve(...args);\n                })}\n              </ProjectModelProvider>\n            </DebugLogProvider>\n          </AccountAuthProvider>\n        </ErrorReporterProvider>\n      </BiProvider>\n    );\n    renderer.waitUntilExit().catch(reject);\n  });\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAO,SAAS,IAAI,SAAiB;AAEnC,UAAQ,IAAI,OAAO;AACrB;;;ACHA;AAAA,mBAAkB;AAclB,eAAsB,eACpB,UACA,OACA,UACY;AACZ,QAAM,WAAW,MAAM,oBAAoB;AAE3C,MAAI,CAAC,UAAU;AACb,UAAM,IAAI,SAAS;AAAA,MACjB,MAAM,aAAa,uBAAuB;AAAA,MAC1C,OAAO;AAAA,IACT,CAAC;AAAA,EACH;AAEA,WAAS,cAAc,QAAQ,EAAE,IAAI,SAAS,SAAS,OAAO,CAAC;AAC/D,gBAAc,SAAS,UAAU,SAAS,SAAS,MAAM;AAEzD,QAAM,WAAW,uBAAuB,EAAE,WAAW,MAAM,CAAC;AAC5D,QAAM,mBAAmB,oBAAoB,MAAM,aAAa;AAEhE,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,aAAS;AAAA,MACP,6BAAAA,QAAA,cAAC,cAAW,OAAO,SAAS,YAC1B,6BAAAA,QAAA,cAAC,yBAAsB,OAAO,SAAS,iBACrC,6BAAAA,QAAA,cAAC,2BACC,6BAAAA,QAAA,cAAC,oBAAiB,UAAU,oBAC1B,6BAAAA,QAAA,cAAC,wBAAqB,OAAO,SAC1B,SAAS,IAAI,SAAS;AACrB,iBAAS,QAAQ;AACjB,gBAAQ,GAAG,IAAI;AAAA,MACjB,CAAC,CACH,CACF,CACF,CACF,CACF;AAAA,IACF;AACA,aAAS,cAAc,EAAE,MAAM,MAAM;AAAA,EACvC,CAAC;AACH;","names":["React"]}