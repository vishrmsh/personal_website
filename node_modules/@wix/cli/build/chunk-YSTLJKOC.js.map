{"version":3,"sources":["../../cli-site-live/src/model.tsx","../../cli-site-live/src/files/wix.config.ts","../../cli-site-live-definitions/src/index.ts"],"sourcesContent":["import React, { createContext, useContext } from 'react';\nimport type { FC, ReactNode } from 'react';\nimport { readWixConfig } from './files/wix.config.js';\n\nexport interface ProjectModel {\n  projectFolder: string;\n  metaSiteId: string;\n  veloAppId: string;\n}\n\nexport async function loadProjectModel(\n  projectFolder: string\n): Promise<ProjectModel> {\n  const config = await readWixConfig(projectFolder);\n  return {\n    projectFolder,\n    metaSiteId: config.siteId,\n    veloAppId: config.veloAppId,\n  };\n}\n\nconst ProjectModelContext = createContext<ProjectModel | null>(null);\n\ninterface Props {\n  model: ProjectModel;\n  children: ReactNode;\n}\n\nexport const ProjectModelProvider: FC<Props> = ({ model, children }) => {\n  return (\n    <ProjectModelContext.Provider value={model}>\n      {children}\n    </ProjectModelContext.Provider>\n  );\n};\n\nexport function useProjectModel(): ProjectModel {\n  const context = useContext(ProjectModelContext);\n  if (context == null) {\n    throw new Error(\n      'useProjectModel() cannot be used without an <ProjectModelProvider>'\n    );\n  }\n  return context;\n}\n","import {\n  WIX_CONFIG_FILENAME,\n  getWixConfigFilePath,\n} from '@wix/cli-core-definitions';\nimport { wixConfigSchema } from '@wix/cli-site-live-definitions';\nimport { readJson } from '@wix/cli-fs';\nimport { CliError, CliErrorCode } from '@wix/cli-error';\n\nexport async function readWixConfig(projectFolder: string) {\n  const configFile = await readJson(getWixConfigFilePath(projectFolder));\n  const config = wixConfigSchema.safeParse(configFile);\n\n  if (config.success) {\n    return config.data;\n  }\n\n  throw new CliError({\n    code: CliErrorCode.InvalidConfigSchemaError({\n      configPath: WIX_CONFIG_FILENAME,\n      zodError: config.error,\n    }),\n    cause: config.error,\n  });\n}\n","import { z } from 'zod';\n\nexport const wixConfigSchema = z.object({\n  siteId: z.string().uuid(),\n  veloAppId: z.string().uuid(),\n});\nexport type WixConfig = z.infer<typeof wixConfigSchema>;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA,mBAAiD;;;ACAjD;;;ACAA;AAEO,IAAM,kBAAkB,EAAE,OAAO;AAAA,EACtC,QAAQ,EAAE,OAAO,EAAE,KAAK;AAAA,EACxB,WAAW,EAAE,OAAO,EAAE,KAAK;AAC7B,CAAC;;;ADGD,eAAsB,cAAc,eAAuB;AACzD,QAAM,aAAa,MAAM,SAAS,qBAAqB,aAAa,CAAC;AACrE,QAAM,SAAS,gBAAgB,UAAU,UAAU;AAEnD,MAAI,OAAO,SAAS;AAClB,WAAO,OAAO;AAAA,EAChB;AAEA,QAAM,IAAI,SAAS;AAAA,IACjB,MAAM,aAAa,yBAAyB;AAAA,MAC1C,YAAY;AAAA,MACZ,UAAU,OAAO;AAAA,IACnB,CAAC;AAAA,IACD,OAAO,OAAO;AAAA,EAChB,CAAC;AACH;;;ADbA,eAAsB,iBACpB,eACuB;AACvB,QAAM,SAAS,MAAM,cAAc,aAAa;AAChD,SAAO;AAAA,IACL;AAAA,IACA,YAAY,OAAO;AAAA,IACnB,WAAW,OAAO;AAAA,EACpB;AACF;AAEA,IAAM,0BAAsB,4BAAmC,IAAI;AAO5D,IAAM,uBAAkC,CAAC,EAAE,OAAO,SAAS,MAAM;AACtE,SACE,6BAAAA,QAAA,cAAC,oBAAoB,UAApB,EAA6B,OAAO,SAClC,QACH;AAEJ;AAEO,SAAS,kBAAgC;AAC9C,QAAM,cAAU,yBAAW,mBAAmB;AAC9C,MAAI,WAAW,MAAM;AACnB,UAAM,IAAI;AAAA,MACR;AAAA,IACF;AAAA,EACF;AACA,SAAO;AACT;","names":["React"]}